/*
vim: syntax=groovy
-*- mode: groovy;-*-
* -------------------------------------------------
* LIBD-RNAseq Nextflow config file
* -------------------------------------------------
* Default config options for all environments.
* Cluster-specific config options should be saved
* in the conf folder and imported under a profile
* name here.
*/

// Profiles

// Start a docker flag variable as false to use when defining the command paths configuration file to use
params.docker_flag = false
// Similarly, start a flag variable for the case when we are using the pipeline at JHPCE
params.jhpce_flag = false

nextflowVersion = '>=0.27.0'  // a "soft" requirement for minimum version

profiles {

  standard {
    includeConfig 'conf/mem.config'
  }
  docker {
    includeConfig 'conf/docker.config'
	params.docker_flag = true
  }
  sge {
    includeConfig 'conf/sge.config'
  }
  sge_large {
    includeConfig 'conf/sge_large.config'
  }
  quick {
    includeConfig 'conf/quick.config'
  }
  jhpce {
    includeConfig 'conf/jhpce.config'
    params.jhpce_flag = true
  }
  slurm {
    includeConfig 'conf/slurm.config'
  }
}

// Capture exit codes from upstream processes when piping
process.shell = ['/bin/bash', '-euo', 'pipefail']

// Define the output directory for pipeline reports
if(params.jhpce_flag) {
    params.logging = '/dcl01/lieber/ajaffe/lab/RNAsp_work/pipeline_log'
} else {
    params.logging = './pipeline_log'
}


// Enable the timeline output
timeline {
 enabled = true
 file = "${params.logging}/LIBD-RNAseq_pipeline.html"
}

// Enable the trace output
trace {
 enabled = true
 file = "${params.logging}/LIBD-RNAseq_trace.txt"
}

// Define the manifest
manifest {
  homePage = 'https://www.libd.org/'
  description = 'The Lieber Institute for Brain Development conducts research in order to advance the understanding of brain disorders and help those affected by them'
  mainScript = 'main.nf'
}

// Define the command_paths file to use.
//For docker, this should be static and different since paths are predefined in the docker image

if (params.docker_flag) {
	// Load configuration values for paths to software commands used by the pipeline
	includeConfig 'conf/docker_command_paths.config'
} else {
    // Load configuration values for paths to software commands used by the pipeline
    includeConfig 'conf/command_paths.config'
}

